### The multiple comparisons problem

In the statistical analysis of MEEG-data we have to deal with the _multiple comparisons problem_ (MCP). This problem originates from the fact that MEEG-data are multidimensional. MEEG-data have a spatiotemporal structure: the signal is sampled at multiple channels and multiple time points (as determined by the sampling frequency). The MCP arises from the fact that the effect of interest (i.e., a difference between experimental conditions) is evaluated at an extremely large number of (channel,time)-pairs. This number is usually in the order of several thousands. Now, the MCP involves that, due to the large number of statistical comparisons (one per (channel,time)-pair), it is not possible to control the so called _family-wise error rate_ (FWER) by means of the standard statistical procedures that operate at the level of single (channel,time)-pairs. The FWER is the probability under the hypothesis of no effect of falsely concluding that there is a difference between the experimental conditions at one or more (channel,time)-pairs. A solution of the MCP requires a procedure that controls the FWER at some critical alpha-level (typically, 0.05 or 0.01). The FWER is also called the _false alarm rate_.

In this tutorial, we describe nonparametric statistical testing of MEEG-data. Contrary to the familiar parametric statistical framework, it is straightforward to solve the MCP in the nonparametric framework. FieldTrip contains a set of statistical functions that provide a solution for the MCP. These are the functions **[ft_timelockstatistics](/reference/ft_timelockstatistics)** and **[ft_freqstatistics](/reference/ft_freqstatistics)** which compute significance probabilities using a non-parametric permutation tests. Besides nonparametric statistical tests, **[ft_timelockstatistics](/reference/ft_timelockstatistics)** and **[ft_freqstatistics](/reference/ft_freqstatistics)** can also perform parametric statistical tests (see the [Parametric and non-parametric statistics on event-related fields](/tutorial/eventrelatedstatistics) tutorial). However, in this tutorial the focus will be on non-parametric testing.

### Structure in experiment and data

#### Different types of data

MEEG-data have a **spatiotemporal** structure: the signal is sampled at multiple channels and multiple time points. Thus, MEEG-data are **two-dimensional**: channels (the spatial dimension) X time-points (the temporal dimension). In the following, these (channel,time)-pairs will be called _samples_. In some studies, these two-dimensional data are reduced to one-dimensional data by averaging over either a selected set of channels or a selected set of time-points.

In many studies, there is an interest in the modulation of oscillatory brain activity. Oscillatory brain activity is measured by power estimates obtained from Fourier or wavelet analyses of single-trial spatiotemporal data. Very often, power estimates are calculated for multiple data segments obtained by sliding a short time window over the complete data segment. In this way, **spatio-spectral-temporal** data are obtained from the raw spatiotemporal data. The spectral dimension consists of the different frequency bins for which the power is calculated. In the following, these (channel,frequency,time)-triplets will be called _samples_. In some studies, these **three-dimensional** data are reduced to one- or two-dimensional data by averaging over a selected set of channels, a selected set of time points, and/or a selected set of frequencies.

#### Structure in an experiment

The data are typically collected in different experimental conditions and the experimenter wants to know if there is a significant difference between the data observed in these conditions. To answer this question, statistical tests are used. To understand these statistical tests one has to know how the structure in the experiment affects the structure in the data. Two concepts are crucial for describing the structure in an experiment:

1.  The concept of a _unit of observation_ (UO).
2.  The concept of a _between- or a within-UO design_.
    In M/EEG experiments, there are two types of UO: subjects and trials (i.e., epochs of time within a subject). Concerning the concept of a between- or a within-UO design, there are two schemes according to which the UOs can be assigned to the experimental conditions: (1) every UO is assigned to only one of a number of experimental conditions (**between** UO-design; **independent** samples), or (2) every UO is assigned to multiple experimental conditions in a particular order (**within** UO-design; **dependent** samples). Therefore, in a between-UO design, there is only one experimental condition per UO, and in a within-UO design there are multiple experimental conditions per UO. These two experimental designs require different test statistics.

The two UO-types (**subjects** and **trials**) and the two experimental designs (between- and within-UO) can be combined and this results in four different types of experiments.

### Computation of the test statistic and its significance probability

The statistical testing in FieldTrip is performed by the functions **[ft_timelockstatistics](/reference/ft_timelockstatistics)** and **[ft_freqstatistics](/reference/ft_freqstatistics)**. From a statistical point of view, the calculations performed by these two functions are very similar. These functions differ with respect to the data structures on which they operate: **[ft_timelockstatistics](/reference/ft_timelockstatistics)** operates on data structures produced by **[ft_timelockanalysis](/reference/ft_timelockanalysis)** and **[ft_timelockgrandaverage](/reference/ft_timelockgrandaverage)**, and **[ft_freqstatistics](/reference/ft_freqstatistics)** operates on data structures produced by **[ft_freqanalysis](/reference/ft_freqanalysis)**, **[ft_freqgrandaverage](/reference/ft_freqgrandaverage)**, and **[ft_freqdescriptives](/reference/ft_freqdescriptives)**.

To correct for multiple comparisons, one has to specify the field cfg.correctm. This field can have the values 'no', 'max', 'cluster', 'bonferroni', 'holms', or 'fdr'. In this tutorial, we only use cfg.correctm = 'cluster', which solves the MCP by calculating a so-called cluster-based test statistic and its significance probability.

#### The calculation of this cluster-based test statistic

1.  For every sample (a (channel,time)-pair or a (channel,frequency,time)-triplet) the experimental conditions are compared by means of a t-value or some other number that quantifies the effect at this sample. It must be noted that this t-value is _not_ the cluster-based test statistic for which we will calculate the significance probability; it is just an ingredient in the calculation of this cluster-based test statistic. Quantifying the effect at the sample level is possible by means of different measures. These measures are specified in cfg.statistic, which can have the values 'ft_statfun_indepsamplesT', 'ft_statfun_depsamplesT', 'ft_statfun_actvsblT', and many others. We will return to this in the following.
2.  All samples are selected whose t-value is larger than some threshold as specified in cfg.clusteralpha. It must be noted that the value of cfg.clusteralpha does _not_ affect the false alarm rate of the statistical test; it only sets a threshold for considering a sample as a candidate member of some cluster of samples. If cfg.clusteralpha is equal to 0.05, the t-values are thresholded at the 95-th quantile for a one-sided t-test, and at the 2.5-th and the 97.5-th quantiles for a two-sided t-test.
3.  Selected samples are clustered in connected sets on the basis of temporal, spatial and spectral adjacency.
4.  Cluster-level statistics are calculated by taking the sum of the t-values within every cluster.
5.  The maximum of the cluster-level statistics is taken. This step and the previous one (step 4) are controlled by cfg.clusterstatistic, which can have the values 'maxsum', 'maxsize', or 'wcm'. In this tutorial, we will only use 'maxsum', which is the default value.
    The result from step 5 is the test statistic by means of which we evaluate the effect of the experimental conditions.

#### The calculation of the significance probability

If the MCP is solved by choosing for a cluster-based test statistic (i.e., with cfg.correctm = 'cluster'), the significance probability can only be calculated by means of the so-called _Monte Carlo method_. This is because the reference distribution for a permutation test can be approximated (to any degree of accuracy) by means of the Monte Carlo method. In the configuration, the Monte Carlo method is chosen as follows: cfg.method = 'montecarlo'.

The Monte Carlo significance probability is calculated differently for a within- and between-UO design. We now show how the Monte Carlo significance probability is calculated for in a between-trials experiment (a between-UO design with trials as UO

1.  Collect the trials of the different experimental conditions in a single set.
2.  Randomly draw as many trials from this combined data set as there were trials in condition 1 and place them into subset 1. The remaining trials are placed in subset 2. The result of this procedure is called a _random partition_.
3.  Calculate the test statistic (i.e., the maximum of the cluster-level summed t-values) on this random partition.
4.  Repeat steps 2 and 3 a large number of times and construct a histogram of the test statistics. The computation of this Monte Carlo approximation involves a user-specified number of random draws (specified in cfg.numrandomization). The accuracy of the Monte Carlo approximation can be increased by choosing a larger value for cfg.numrandomization.
5.  From the test statistic that was actually observed and the histogram in step 4, calculate the proportion of random partitions that resulted in a larger test statistic than the observed one. This proportion is the Monte Carlo significance probability, which is also called a _p-value_.

If the p-value is smaller than the critical alpha-level (typically 0.05) then we conclude that the data in the two experimental conditions are significantly different. This p-value can also be calculated for the second largest cluster-level statistic, the third largest, etc. It is common practice to say that a cluster is significant if its p-value is less than the critical alpha-level. This practice suggests that it is possible to do spatio-spectral-temporal localization by means of the cluster-based permutation test. However, from a statistical perspective, this suggestion is not justified. Consult [Maris and Oostenveld, Journal of Neuroscience Methods, 2007](/references_to_implemented_methods#statistical_inference_by_means_of_permutation) for an elaboration on this topic.
